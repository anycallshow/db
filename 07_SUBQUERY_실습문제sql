--1
SELECT EMP_ID, EMP_NAME,PHONE, TO_CHAR(HIRE_DATE,'YY/MM/DD')
FROM EMPLOYEE
WHERE DEPT_CODE = (SELECT DEPT_CODE
                    FROM EMPLOYEE
                    WHERE EMP_NAME = '전지연')
AND EMP_NAME != '전지연';

--2
SELECT EMP_ID, EMP_NAME, PHONE, SALARY, JOB_NAME
FROM EMPLOYEE
JOIN JOB USING(JOB_CODE)
WHERE SALARY = (SELECT MAX(SALARY)
                FROM EMPLOYEE
                WHERE SUBSTR(HIRE_DATE,1,4) >= 2000
                );
--3
SELECT EMP_ID, EMP_NAME, DEPT_CODE,JOB_CODE,DEPT_TITLE,JOB_NAME
FROM EMPLOYEE
JOIN DEPARTMENT ON(DEPT_CODE = DEPT_ID)
JOIN JOB USING(JOB_CODE)
WHERE (DEPT_CODE,JOB_CODE) = (SELECT DEPT_CODE, JOB_CODE
                            FROM EMPLOYEE
                            WHERE EMP_NAME = '노옹철')
AND EMP_NAME != '노옹철';

--4

SELECT EMP_ID, EMP_NAME, DEPT_CODE, JOB_CODE, TO_CHAR(HIRE_DATE,'YY/MM/DD')
FROM EMPLOYEE
WHERE (DEPT_CODE, JOB_CODE) = (SELECT DEPT_CODE,JOB_CODE
                                FROM EMPLOYEE
                                WHERE SUBSTR(HIRE_DATE,1,4) =2000
                                );
                                
--5 
SELECT EMP_ID, EMP_NAME, DEPT_CODE, MANAGER_ID, EMP_NO, HIRE_DATE
FROM EMPLOYEE
WHERE (DEPT_CODE, MANAGER_ID) = (SELECT DEPT_CODE, MANAGER_ID
                                 FROM EMPLOYEE
                                 WHERE SUBSTR(EMP_NO,1,2) = 77
                                 AND SUBSTR(EMP_NO,8,1) = 2);

--6
SELECT EMP_ID, EMP_NAME, NVL(DEPT_TITLE,'소속없음'),JOB_NAME, HIRE_DATE
FROM EMPLOYEE
LEFT JOIN DEPARTMENT ON(DEPT_CODE = DEPT_ID)
JOIN JOB USING(JOB_CODE)
WHERE HIRE_DATE IN ( SELECT MIN(HIRE_DATE)
                    FROM EMPLOYEE
                    WHERE ENT_YN ='N'
                    GROUP BY DEPT_CODE)
ORDER BY 5 ;

SELECT EMP_ID, EMP_NAME, NVL(DEPT_TITLE,'소속없음'),JOB_NAME, HIRE_DATE
FROM EMPLOYEE E
LEFT JOIN DEPARTMENT ON(DEPT_CODE = DEPT_ID)
JOIN JOB USING(JOB_CODE)
WHERE HIRE_DATE = (SELECT MIN(HIRE_DATE)
                    FROM EMPLOYEE E2
                    WHERE E.DEPT_CODE = E2.DEPT_CODE
                    OR (E.DEPT_CODE IS NULL AND E2.DEPT_CODE IS NULL)
                    AND ENT_YN = 'N');

--7
SELECT EMP_ID,EMP_NAME, JOB_NAME, EXTRACT(YEAR FROM SYSDATE) - EXTRACT(YEAR FROM TO_DATE(SUBSTR(EMP_NO,1,6),'RRMMDD')) 나이
       , TO_CHAR(SALARY*(1+NVL(BONUS,0))*12,'L999,999,999') 보너스포함연봉  , EMP_NO
FROM EMPLOYEE E
JOIN JOB J ON (E.JOB_CODE = J.JOB_CODE)
WHERE  EMP_NO = (SELECT MAX(EMP_NO)
                  FROM EMPLOYEE E1
                  WHERE E.JOB_CODE = E1.JOB_CODE)
ORDER BY 4 DESC;
